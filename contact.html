<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تواصل معنا - DRAGON FREE</title>
<link rel="stylesheet" href="css/style.css">
<script src="js/main.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
<header>تواصل معنا - DRAGON FREE</header>

<div style="text-align:center; margin:20px;">
    <button onclick="window.location.href='index.html'" style="background:#ff4b4b; color:white; border:none; padding:15px 30px; border-radius:8px; font-size:16px; margin:5px; cursor:pointer;">العودة للرئيسية</button>
    <button onclick="toggleMode()" style="background:#ff4b4b; color:white; border:none; padding:15px 30px; border-radius:8px; font-size:16px; margin:5px; cursor:pointer;">وضع ليلي/نهاري</button>
</div>

<div class="container">
    <div class="card" style="background:#2d2d2d; padding:40px; border-radius:15px; max-width:600px; margin:30px auto;">
        <h3 style="text-align:center; color:#fff; font-size:24px; margin-bottom:30px;">أرسل لنا رسالة</h3>
        
        <form onsubmit="sendMessage(event)">
            <div style="margin-bottom:20px;">
                <input type="text" id="discord" placeholder="معرف الديسكورد" pattern="[0-9]{17,19}" required 
                style="width:100%; padding:18px; border-radius:10px; border:none; background:#fff; color:#666; font-size:15px; box-sizing:border-box;">
            </div>
            
            <div style="margin-bottom:25px;">
                <textarea id="message" placeholder="اكتب رسالتك هنا..." required 
                style="width:100%; padding:18px; border-radius:10px; border:none; background:#fff; color:#666; font-size:15px; min-height:130px; resize:vertical; box-sizing:border-box; font-family:inherit;"></textarea>
            </div>
            
            <button type="submit" id="submitBtn" 
            style="display:block; margin:0 auto; background:#ff4b4b; color:white; border:none; padding:15px 50px; border-radius:10px; font-size:18px; font-weight:bold; cursor:pointer;">
                إرسال
            </button>
        </form>
        
        <p id="status" style="margin-top:20px; padding:12px; border-radius:8px; text-align:center; font-weight:bold; display:none;"></p>
    </div>
</div>

<script>
// إرسال الرسالة عبر Discord Webhook
async function sendMessage(e) {
    e.preventDefault();
    
    const discord = document.getElementById('discord').value;
    const message = document.getElementById('message').value;
    const submitBtn = document.getElementById('submitBtn');
    const status = document.getElementById('status');
    
    submitBtn.disabled = true;
    submitBtn.textContent = 'جاري الإرسال...';
    status.style.display = 'none';
    
    const webhookURL = 'https://discord.com/api/webhooks/1429173843494178856/CU1t2MZS0QGyZQT7FG-DGgjrOvRKijsCustfv-i0aEghedOZ44U_DTK-owxj3SkhQVUw';
    
    const content = `العضو: <@${discord}>`;
    
    const payload = {
        content: content,
        embeds: [{
            title: '📩 رسالة جديدة من الموقع',
            color: 16711680,
            fields: [
                {
                    name: '🎮 معرف الديسكورد',
                    value: discord,
                    inline: false
                },
                {
                    name: '💬 الرسالة',
                    value: message,
                    inline: false
                }
            ],
            timestamp: new Date().toISOString(),
            footer: {
                text: 'DRAGON FREE Contact Form'
            }
        }]
    };
    
    try {
        const response1 = await fetch(webhookURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(payload)
        });
        
        if (!response1.ok) {
            throw new Error('فشل الإرسال');
        }
        
        await new Promise(resolve => setTimeout(resolve, 500));
        
        const response2 = await fetch(webhookURL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                content: '<@&1378647724039344149>'
            })
        });
        
        if (response2.ok) {
            status.textContent = '✅ تم إرسال رسالتك بنجاح! سنرد عليك قريباً.';
            status.style.background = 'rgba(76, 175, 80, 0.2)';
            status.style.color = '#4caf50';
            status.style.border = '2px solid #4caf50';
            status.style.display = 'block';
            document.getElementById('discord').value = '';
            document.getElementById('message').value = '';
        } else {
            throw new Error('فشل الإرسال');
        }
    } catch (error) {
        status.textContent = '❌ حدث خطأ أثناء الإرسال. حاول مرة أخرى.';
        status.style.background = 'rgba(244, 67, 54, 0.2)';
        status.style.color = '#f44336';
        status.style.border = '2px solid #f44336';
        status.style.display = 'block';
    } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'إرسال';
    }
}
</script>

<footer>DRAGON FREE © 2025</footer>
</body>
</html>
