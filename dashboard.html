<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة التحكم - DRAGON COIN</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Cairo',sans-serif;transition:0.3s;}
body{background-color:#0d1117;color:#fff;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:20px;}
.container{background-color:#161b22;padding:30px;border-radius:15px;width:90%;max-width:500px;text-align:center;box-shadow:0 0 15px rgba(0,0,0,0.4);border:1px solid #30363d;margin-bottom:20px;}
h1{color:#ff5555;margin-bottom:20px;}
button{width:100%;padding:12px;background-color:#ff5555;color:#fff;border:none;border-radius:8px;font-size:16px;cursor:pointer;margin:10px 0;}
button:hover{background-color:#cc4444;}
.toggle,.langBtn{background-color:#21262d;margin-top:10px;color:#fff;}
.toggle:hover,.langBtn:hover{background-color:#30363d;}
.light-mode{background-color:#f4f4f4;color:#000;}
.light-mode .container{background-color:#fff;border-color:#ccc;color:#000;}
.light-mode button{background-color:#ff5555;color:#fff;}
.light-mode .toggle,.light-mode .langBtn{background-color:#ddd;color:#000;}
.light-mode h1{color:#ff5555;}
</style>
</head>
<body>

<div class="container" id="dashboardContainer">
  <h1 id="welcomeText">مرحبا <span id="userDisplay"></span>!</h1>
  <p id="balanceText">رصيدك الحالي: <span id="balance">0</span> DRAGON COIN</p>
  <button id="dailyBtn" onclick="addCoins()">💰 هدية يومية عشوائية</button>
  <button id="transferBtn" onclick="transfer()">💸 تحويل عملة</button>
  <button onclick="logout()">تسجيل خروج</button>
  <button class="toggle" onclick="toggleMode()">🌙 / ☀️</button>
  <button class="langBtn" onclick="toggleLanguage()">ع / E</button>
</div>

<script>
// الوضع الداكن
let darkMode = localStorage.getItem('darkMode')==='true';
applyMode();

// اللغة
let lang = localStorage.getItem('lang') || 'ar';
applyLanguage();

// المستخدم
const username = localStorage.getItem('username');
if(!username || localStorage.getItem('loggedIn')!=='true'){
  alert('❌ لم يتم تسجيل الدخول!');
  window.location.href = "login.html";
}
document.getElementById('userDisplay').textContent = username;

// الرصيد
let balances = JSON.parse(localStorage.getItem('balances')||'{}');
if(!balances[username]) balances[username]=0;
updateBalance();

function addCoins(){
  const amount=(Math.random()*0.5+0.5).toFixed(2);
  balances[username]+=parseFloat(amount);
  localStorage.setItem('balances',JSON.stringify(balances));
  updateBalance();
  alert((lang==='ar'?'🎁 حصلت على ':'🎁 You received ')+amount+' DRAGON COIN');
}
function updateBalance(){document.getElementById('balance').textContent=balances[username].toFixed(2);}

function transfer(){
  const target=prompt(lang==='ar'?'ادخل اسم المستخدم المستلم:':'Enter recipient username:');
  if(!target){alert(lang==='ar'?'الاسم ناقص':'Name missing');return;}
  const amt=parseFloat(prompt(lang==='ar'?'ادخل المبلغ:':'Enter amount:'));
  if(isNaN(amt)||amt<=0){alert(lang==='ar'?'المبلغ غير صحيح':'Invalid amount');return;}
  if(amt>balances[username]){alert(lang==='ar'?'رصيدك غير كافي':'Insufficient balance');return;}
  let bal=JSON.parse(localStorage.getItem('balances')||'{}');
  if(!bal[target]) bal[target]=0;
  bal[username]-=amt;
  bal[target]+=amt;
  localStorage.setItem('balances',JSON.stringify(bal));
  balances=bal;
  updateBalance();
  alert((lang==='ar'?'✅ تم تحويل ':'✅ Transferred ')+amt+' DRAGON COIN إلى '+target);
}

function logout(){
  localStorage.removeItem('loggedIn');
  localStorage.removeItem('username');
  localStorage.removeItem('rememberedUser');
  window.location.href="login.html";
}

function toggleMode(){darkMode=!darkMode;localStorage.setItem('darkMode',darkMode);applyMode();}
function applyMode(){if(darkMode){document.body.classList.remove('light-mode');}else{document.body.classList.add('light-mode');}}

function toggleLanguage(){lang=(lang==='ar')?'en':'ar';localStorage.setItem('lang',lang);applyLanguage();}
function applyLanguage(){
  if(lang==='ar'){
    document.getElementById('welcomeText').innerHTML=`مرحبا <span id="userDisplay">${username}</span>!`;
    document.getElementById('balanceText').innerHTML=`رصيدك الحالي: <span id="balance">${balances[username].toFixed(2)}</span> DRAGON COIN`;
    document.getElementById('dailyBtn').textContent='💰 هدية يومية عشوائية';
    document.getElementById('transferBtn').textContent='💸 تحويل عملة';
  } else {
    document.getElementById('welcomeText').innerHTML=`Welcome <span id="userDisplay">${username}</span>!`;
    document.getElementById('balanceText').innerHTML=`Balance: <span id="balance">${balances[username].toFixed(2)}</span> DRAGON COIN`;
    document.getElementById('dailyBtn').textContent='💰 Daily Random Gift';
    document.getElementById('transferBtn').textContent='💸 Transfer Coins';
  }
}
</script>
</body>
</html>